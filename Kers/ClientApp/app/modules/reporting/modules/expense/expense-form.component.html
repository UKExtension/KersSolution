<div class="alert alert-danger alert-dismissible fade in" role="alert" *ngIf="errorMessage">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">Ã—</span>
    </button>
    <strong>Error: </strong> {{errorMessage}}
</div>
<loading *ngIf="loading"></loading>
<div class="row" *ngIf="!loading">
    <div><reporting-display-help id="5"></reporting-display-help></div>
    <div class="col-sm-offset-3 col-sm-9">
        <h2 *ngIf="!expense">New Expense Record</h2>
        <h2 *ngIf="expense">Edit Expense Record</h2>
    </div>
    <form class="form-horizontal form-label-left col-sm-12" novalidate (ngSubmit)="onSubmit()" [formGroup]="expenseForm">
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="rDT">Activity Date:</label>
            <div class="col-md-5 col-sm-7 col-xs-8">
                <my-date-picker [options]="myDatePickerOptions" formControlName="expenseDate"></my-date-picker>
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="expenseLocation">Location:</label>
            <div class="col-md-9 col-sm-9 col-xs-12">
                    <input type="text" name="expenseLocation" id="expenseLocation" formControlName="expenseLocation" class="form-control col-md-7 col-xs-12">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="fundingSourceMileageId">Mileage Funding Source: </label>
            <div class="col-md-9 col-sm-9 col-xs-12">
                <select [class.ng-invalid]="expenseForm.hasError('noMileageSource')" name="fundingSourceMileageId" id="fundingSourceMileageId" formControlName="fundingSourceMileageId" class="form-control col-md-7 col-xs-12" >
                    <option value="">--- select ---</option>
                    <option *ngFor="let source of fundingSources | async" [value]="source.id">{{source.name}}</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="mileage">Mileage (miles):</label>
            <div class="col-md-3 col-sm-4 col-xs-6">
                    <input type="text" name="mileage" id="mileage" formControlName="mileage" class="form-control col-md-7 col-xs-12">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="fundingSourceNonMileageId">Expense Funding Source: </label>
            <div class="col-md-9 col-sm-9 col-xs-12">
                <select [class.ng-invalid]="expenseForm.hasError('noExpenseSource')" name="fundingSourceNonMileageId" id="fundingSourceNonMileageId" formControlName="fundingSourceNonMileageId" class="form-control col-md-7 col-xs-12" >
                    <option value="">--- select ---</option>
                    <option *ngFor="let source of fundingSources | async" [value]="source.id">{{source.name}}</option>
                </select>
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="registration">Registration ($):</label>
            <div class="col-md-3 col-sm-4 col-xs-6">
                    <input type="text" name="registration" id="registration" formControlName="registration" class="form-control col-md-7 col-xs-12">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="lodging">Lodging ($):</label>
            <div class="col-md-3 col-sm-4 col-xs-6">
                    <input type="text" name="lodging" id="lodging" formControlName="lodging" class="form-control col-md-7 col-xs-12">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="mealRateBreakfastId">Breakfast: </label>
            <div class="col-md-9 col-sm-9 col-xs-12">
                <select name="mealRateBreakfastId" id="mealRateBreakfastId" formControlName="mealRateBreakfastId" class="form-control col-md-7 col-xs-12" (change)="breakfastChange($event)">
                    <option value="">None</option>
                    <option *ngFor="let mealRate of mealRates | async" [value]="mealRate.id">(${{mealRate.breakfastRate | number:'1.2-2'}}) {{mealRate.description}}</option>
                    <option value="custom">Custom Amount</option>
                </select>
            </div>
        </div>
        <div class="form-group" *ngIf="customBrakefastRate">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="mealRateBreakfastCustom">Custom Breakfast Rate:</label>
            <div class="col-md-3 col-sm-4 col-xs-6">
                    <input type="text" name="mealRateBreakfastCustom" id="mealRateBreakfastCustom" formControlName="mealRateBreakfastCustom" class="form-control col-md-7 col-xs-12">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="mealRateLunchId">Lunch: </label>
            <div class="col-md-9 col-sm-9 col-xs-12">
                <select name="mealRateLunchId" id="mealRateLunchId" formControlName="mealRateLunchId" class="form-control col-md-7 col-xs-12" (change)="lunchChange($event)">
                    <option value="">None</option>
                    <option *ngFor="let mealRate of mealRates | async" [value]="mealRate.id">(${{mealRate.lunchRate | number:'1.2-2'}}) {{mealRate.description}}</option>
                    <option value="custom">Custom Amount</option>
                </select>
            </div>
        </div>
        <div class="form-group" *ngIf="customLunchRate">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="mealRateLunchCustom">Custom Lunch Rate:</label>
            <div class="col-md-3 col-sm-4 col-xs-6">
                    <input type="text" name="mealRateLunchCustom" id="mealRateLunchCustom" formControlName="mealRateLunchCustom" class="form-control col-md-7 col-xs-12">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="mealRateDinnerId">Dinner: </label>
            <div class="col-md-9 col-sm-9 col-xs-12">
                <select name="mealRateDinnerId" id="mealRateDinnerId" formControlName="mealRateDinnerId" class="form-control col-md-7 col-xs-12" (change)="dinnerChange($event)">
                    <option value="">None</option>
                    <option *ngFor="let mealRate of mealRates | async" [value]="mealRate.id">(${{mealRate.dinnerRate | number:'1.2-2'}}) {{mealRate.description}}</option>
                    <option value="custom">Custom Amount</option>
                </select>
            </div>
        </div>
        <div class="form-group" *ngIf="customDinnerRate">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="mealRateDinnerCustom">Custom Dinner Rate:</label>
            <div class="col-md-3 col-sm-4 col-xs-6">
                    <input type="text" name="mealRateDinnerCustom" id="mealRateDinnerCustom" formControlName="mealRateDinnerCustom" class="form-control col-md-7 col-xs-12">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="otherExpenseCost">Other Expense Amount ($):</label>
            <div class="col-md-3 col-sm-4 col-xs-6">
                    <input type="text" name="otherExpenseCost" id="otherExpenseCost" formControlName="otherExpenseCost" class="form-control col-md-7 col-xs-12">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="otherExpenseExplanation">Explanation for other expense(s):</label>
            <div class="col-md-9 col-sm-9 col-xs-12">
                    <input type="text" name="otherExpenseExplanation" id="otherExpenseExplanation" formControlName="otherExpenseExplanation" class="form-control col-md-7 col-xs-12">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="title">Depart: </label>
            <div class="col-md-9 col-sm-9 col-xs-12">
                <timepicker empty="-- Select Departing Time --" formControlName="departTime"></timepicker>
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-3 col-sm-3 col-xs-12" for="returnTime">Return: </label>
            <div class="col-md-9 col-sm-9 col-xs-12">
                <timepicker empty="-- Select Return Time --" formControlName="returnTime"></timepicker>
            </div>
        </div>
        
        <div class="ln_solid"></div>
        <div class="form-group">
            <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
                <a class="btn btn-primary" (click)="onCancel()">Cancel</a>
                <button type="submit" [disabled]="expenseForm.invalid"  class="btn btn-success">Submit</button>
            </div>
        </div>
        
    </form>
</div>